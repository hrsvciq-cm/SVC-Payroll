# المنطق الجديد لحساب الرواتب

## المبدأ الأساسي

**حساب تلقائي للرواتب الشهرية يعتمد على عدد أيام الحضور فقط**

## المعادلة

```
الراتب اليومي = الراتب الأساسي ÷ أيام العمل (30 يوم)
الراتب الشهري = الراتب اليومي × أيام الحضور
```

## مثال توضيحي

### السيناريو:
- **الراتب الأساسي**: 3000 ريال
- **أيام الحضور**: 25 يوم
- **أيام الغياب**: 5 أيام

### الحساب:

#### 1. حساب الراتب اليومي:
```
الراتب اليومي = 3000 ÷ 30 = 100 ريال/يوم
```

#### 2. حساب الراتب الشهري:
```
الراتب الشهري = 100 × 25 = 2500 ريال
```

### النتيجة:
- **الراتب الأساسي المحسوب**: 2500 ريال (يعتمد على أيام الحضور فقط)
- **لا يوجد خصم للغياب** - لأن الراتب يعتمد على الحضور فقط

---

## الفرق بين المنطق القديم والجديد

### المنطق القديم (خطأ):
```
الراتب الأساسي = 3000 (ثابت)
خصم الغياب = 100 × 5 = 500
صافي الراتب = 3000 - 500 = 2500
```

### المنطق الجديد (صحيح):
```
الراتب اليومي = 3000 ÷ 30 = 100
الراتب الشهري = 100 × 25 = 2500
صافي الراتب = 2500 + مكافآت - خصومات - سلف
```

---

## الحالات الخاصة

### 1. موظف بدأ في منتصف الشهر:
- يتم حساب الراتب فقط للأيام من تاريخ التعيين
- مثال: بدأ في 15 فبراير → يحسب فقط من 15 إلى 28 فبراير

### 2. موظف منتهي الخدمة:
- يتم حساب الراتب فقط للأيام حتى تاريخ الإنهاء
- مثال: انتهت خدمته في 20 فبراير → يحسب فقط من 1 إلى 20 فبراير

### 3. موظف موقوف:
- **مع راتب**: يحسب للأيام قبل الإيقاف
- **بدون راتب**: الراتب = 0

---

## الإضافات على الراتب

بعد حساب الراتب الأساسي (بناءً على أيام الحضور)، يتم إضافة/خصم:

### الإضافات:
- ✅ **الساعات الإضافية**: تُضاف إلى الراتب
- ✅ **المكافآت**: تُضاف إلى الراتب

### الخصومات:
- ❌ **التأخير الزمني**: يُخصم من الراتب (دقيقة بدقيقة)
- ❌ **التأخير غير الزمني**: يُخصم من الراتب (دقيقة = دقيقتين)
- ❌ **الخصومات**: تُخصم من الراتب
- ❌ **السلف**: تُخصم من الراتب

---

## صيغة الحساب النهائية

```
الراتب اليومي = الراتب الأساسي ÷ 30
الراتب الأساسي المحسوب = الراتب اليومي × أيام الحضور

صافي الراتب = الراتب الأساسي المحسوب
             + الساعات الإضافية
             + المكافآت
             - التأخير الزمني
             - التأخير غير الزمني
             - الخصومات
             - السلف
```

---

## ملاحظات مهمة

1. ✅ **الراتب يعتمد فقط على أيام الحضور** - لا يوجد خصم للغياب
2. ✅ **الغياب بدون تبليغ** لا يؤثر على الحساب (لأن الراتب يعتمد على الحضور فقط)
3. ✅ **الغياب بتبليغ** لا يؤثر على الحساب (لأن الراتب يعتمد على الحضور فقط)
4. ✅ **الإجازات والعطل** لا تُحسب كأيام حضور

---

## مثال شامل

### بيانات الموظف:
- الراتب الأساسي: 3000 ريال
- أيام الحضور: 20 يوم
- أيام الغياب: 5 أيام
- أيام الإجازة: 3 أيام
- ساعات إضافية: 10 ساعات
- تأخير زمني: 60 دقيقة
- مكافأة: 200 ريال
- خصم: 100 ريال

### الحساب:

#### 1. الراتب اليومي:
```
100 = 3000 ÷ 30
```

#### 2. الراتب الأساسي المحسوب:
```
2000 = 100 × 20 (أيام الحضور فقط)
```

#### 3. الساعات الإضافية:
```
125 = 10 × 12.5 (12.5 = 3000 ÷ (30 × 8))
```

#### 4. التأخير الزمني:
```
12.5 = 60 × 0.208 (0.208 = 12.5 ÷ 60)
```

#### 5. صافي الراتب:
```
2212.5 = 2000 + 125 + 200 - 12.5 - 100
```

---

## التحقق من الحساب

بعد إعادة حساب الرواتب، تحقق من:
1. ✅ الراتب الأساسي = الراتب اليومي × أيام الحضور
2. ✅ لا يوجد خصم للغياب
3. ✅ الساعات الإضافية تُضاف بشكل صحيح
4. ✅ التأخيرات تُخصم بشكل صحيح
5. ✅ المكافآت والخصومات تُطبق بشكل صحيح

