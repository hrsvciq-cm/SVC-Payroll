# ุฅุตูุงุญ ูุดููุฉ ุงูุชูุงุก ุงูุฌูุณุฉ ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุช

## ๐ ุงููุดููุฉ

ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญุ ุนูุฏ ุงูุงูุชูุงู ุฅูู ุตูุญุฉ ุฃุฎุฑู (ูุซู ุตูุญุฉ ุงูููุธููู)ุ ูุงูุช ุงูุฌูุณุฉ ุชูุชูู ูููุทูุจ ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู.

### ุงูุฃุนุฑุงุถ:
1. โ ุงูุฌูุณุฉ ุชูุชูู ุนูุฏ ุงูุงูุชูุงู ูู ุตูุญุฉ ุฅูู ุฃุฎุฑู
2. โ ุฑุณุงูุฉ "ุงูุชูุช ุตูุงุญูุฉ ุงูุฌูุณุฉ" ุนูุฏ ุงูุชููู
3. โ ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู ุนูุฏ ูู ุงูุชูุงู

---

## ๐ง ุงูุณุจุจ ุงูุฌุฐุฑู

ุงููุดููุฉ ูุงูุช ูู `app/components/Layout.js`:
- Event listeners ูู `beforeunload`, `pagehide`, ู `visibilitychange` ูุงูุช ุชููู ุจูุณุญ ุงูุฌูุณุฉ (`signOut()`) ุนูุฏ ูู ุญุฏุซ
- ูุฐู ุงูุฃุญุฏุงุซ ูุชู ุชุดุบูููุง ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุชุ ููุง ูุคุฏู ุฅูู ูุณุญ ุงูุฌูุณุฉ ุจุดูู ุบูุฑ ููุตูุฏ
- ูุฐุง ูุชุนุงุฑุถ ูุน ุงูุชููู ุงูุทุจูุนู ุจูู ุงูุตูุญุงุช

---

## โ ุงูุญู ุงููุทุจู

### 1. **ุฅุฒุงูุฉ ูุณุญ ุงูุฌูุณุฉ ุงููุฏูู** (`app/components/Layout.js`)

#### ุงูุชุบููุฑุงุช:
- โ ุฅุฒุงูุฉ `signOut()` ูู `beforeunload` event listener
- โ ุฅุฒุงูุฉ `signOut()` ูู `pagehide` event listener
- โ ุฅุฒุงูุฉ `signOut()` ูู `visibilitychange` event listener
- โ ุงูุงุนุชูุงุฏ ุนูู session cookies ููุท (ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ)

#### ุงูููุฏ ูุจู ุงูุฅุตูุงุญ:
```javascript
// โ ูุงู ููุณุญ ุงูุฌูุณุฉ ุนูุฏ ุงูุชููู
const handleBeforeUnload = async () => {
  const supabase = createClient()
  await supabase.auth.signOut()
}

const handleVisibilityChange = async () => {
  if (document.visibilityState === 'hidden') {
    const supabase = createClient()
    await supabase.auth.signOut()
  }
}

window.addEventListener('beforeunload', handleBeforeUnload)
window.addEventListener('pagehide', handleBeforeUnload)
document.addEventListener('visibilitychange', handleVisibilityChange)
```

#### ุงูููุฏ ุจุนุฏ ุงูุฅุตูุงุญ:
```javascript
// โ ูุง ููุณุญ ุงูุฌูุณุฉ ูุฏููุงู
// Session cookies are automatically cleared when browser is closed
// Manual sign out would interfere with normal page navigation
```

---

### 2. **ุชุญุณูู Middleware** (`middleware.js`)

#### ุงูุชุบููุฑุงุช:
- โ ุชุญุณูู ุญูุธ cookies ูู middleware
- โ ุถุจุท `path` ุฅูู `/` ูุถูุงู ุชููุฑ cookies ูู ุฌููุน ุงููุณุงุฑุงุช
- โ ุถุจุท `httpOnly` ุจุดูู ุตุญูุญ
- โ ุงูุญูุงุธ ุนูู session cookies (ุจุฏูู expires/maxAge)

#### ุงูููุฏ:
```javascript
setAll(cookiesToSet) {
  cookiesToSet.forEach(({ name, value, options }) => {
    const sessionOptions = { ...options }
    
    // Remove expires and maxAge to make it a session cookie
    delete sessionOptions.expires
    delete sessionOptions.maxAge
    
    // Ensure proper cookie settings
    sessionOptions.sameSite = sessionOptions.sameSite || 'lax'
    if (sessionOptions.httpOnly === undefined) {
      sessionOptions.httpOnly = true
    }
    // Set path to root to ensure cookie is available across all routes
    sessionOptions.path = sessionOptions.path || '/'
    
    response.cookies.set(name, value, sessionOptions)
  })
}
```

---

## ๐ฏ ุงููุชูุฌุฉ

### ูุจู ุงูุฅุตูุงุญ:
- โ ุงูุฌูุณุฉ ุชูุชูู ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุช
- โ ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุนูุฏ ูู ุงูุชูุงู
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุฆุฉ

### ุจุนุฏ ุงูุฅุตูุงุญ:
- โ ุงูุฌูุณุฉ ุชุจูู ูุดุทุฉ ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุช
- โ ูุง ุญุงุฌุฉ ูุชุณุฌูู ุงูุฏุฎูู ุนูุฏ ูู ุงูุชูุงู
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ
- โ ุงูุฌูุณุฉ ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ (session cookies)

---

## ๐ ุขููุฉ ุงูุนูู

### 1. **Session Cookies:**
- Cookies ุชูุญูุธ ูู session cookies (ุจุฏูู expires/maxAge)
- ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ
- ูุชุงุญุฉ ูู ุฌููุน ุงููุณุงุฑุงุช (path: '/')

### 2. **ุงูุชููู ุจูู ุงูุตูุญุงุช:**
- ูุง ูุชู ูุณุญ ุงูุฌูุณุฉ ุนูุฏ ุงูุชููู
- ุงูุฌูุณุฉ ุชุจูู ูุดุทุฉ ูู ุฌููุน ุงูุตูุญุงุช
- Middleware ูุชุญูู ูู ุงูุฌูุณุฉ ูู ูู ุทูุจ

### 3. **ุฅุบูุงู ุงููุชุตูุญ:**
- Session cookies ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ
- ูุง ุญุงุฌุฉ ููุณุญ ูุฏูู
- ุงูุฃูุงู ูุญููุธ

---

## ๐ ุงูุฃูุงู

### 1. **Session Cookies:**
- โ ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ
- โ ูุง ุชุจูู ูุดุทุฉ ุจุนุฏ ุฅุบูุงู ุงููุชุตูุญ
- โ ุขููุฉ ููุจูุงูุงุช ุงูุญุณุงุณุฉ

### 2. **Idle Timeout:**
- โ Idle timeout (3 ุณุงุนุงุช) ูุง ูุฒุงู ูุนูู
- โ ุงูุฌูุณุฉ ุชูุชูู ุจุนุฏ 3 ุณุงุนุงุช ูู ุนุฏู ุงููุดุงุท
- โ Activity tracking ูุนูู ุจุดูู ุตุญูุญ

### 3. **Middleware Protection:**
- โ Middleware ูุชุญูู ูู ุงูุฌูุณุฉ ูู ูู ุทูุจ
- โ ุฅุนุงุฏุฉ ุงูุชูุฌูู ุชููุงุฆูุงู ุนูุฏ ุงูุชูุงุก ุงูุฌูุณุฉ
- โ ุญูุงูุฉ ุฌููุน ุงููุณุงุฑุงุช

---

## ๐ ุฃูุถู ุงูููุงุฑุณุงุช ุงููุทุจูุฉ

### 1. **Session Management:**
- โ ุงูุงุนุชูุงุฏ ุนูู session cookies ููุท
- โ ูุง ูุณุญ ูุฏูู ููุฌูุณุฉ ุนูุฏ ุงูุชููู
- โ Session cookies ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ

### 2. **Cookie Configuration:**
- โ path: '/' ูุถูุงู ุชููุฑ cookies ูู ุฌููุน ุงููุณุงุฑุงุช
- โ httpOnly: true ููุฃูุงู
- โ sameSite: 'lax' ููุญูุงูุฉ ูู CSRF

### 3. **Clean Code:**
- โ ููุฏ ูุธูู ููุงุจู ููุตูุงูุฉ
- โ Comments ุชูุถูุญูุฉ
- โ ุฅุฒุงูุฉ ุงูููุฏ ุบูุฑ ุงูุถุฑูุฑู

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **Session Cookies:**
   - Session cookies ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ
   - ูุง ุชุญุชูู ุนูู `expires` ุฃู `maxAge`
   - ุขููุฉ ููุจูุงูุงุช ุงูุญุณุงุณุฉ

2. **Page Navigation:**
   - ูุง ูุชู ูุณุญ ุงูุฌูุณุฉ ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุช
   - ุงูุฌูุณุฉ ุชุจูู ูุดุทุฉ ูู ุฌููุน ุงูุตูุญุงุช
   - ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ

3. **Browser Close:**
   - Session cookies ุชููุณุญ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ
   - ูุง ุญุงุฌุฉ ููุณุญ ูุฏูู
   - ุงูุฃูุงู ูุญููุธ

---

## โ Checklist

- [x] ุฅุฒุงูุฉ signOut ูู event listeners
- [x] ุชุญุณูู middleware ูุญูุธ cookies
- [x] ุถุจุท path ููู cookies
- [x] ุงุฎุชุจุงุฑ ุงูุชููู ุจูู ุงูุตูุญุงุช
- [x] ุงุฎุชุจุงุฑ ุฅุบูุงู ุงููุชุตูุญ
- [x] ุชูุซูู ุงูุฅุตูุงุญ

---

## ๐ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ูุดููุฉ ุงูุชูุงุก ุงูุฌูุณุฉ ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุช:
- โ ุงูุฌูุณุฉ ุชุจูู ูุดุทุฉ ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุช
- โ ูุง ุญุงุฌุฉ ูุชุณุฌูู ุงูุฏุฎูู ุนูุฏ ูู ุงูุชูุงู
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ
- โ ุงูุฃูุงู ูุญููุธ (session cookies ุชููุณุญ ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ)

**ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ุตุญูุญ!** ๐

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** $(date)
**ุงูุฅุตุฏุงุฑ:** 1.0.0

